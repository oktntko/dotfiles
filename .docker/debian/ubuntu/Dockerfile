FROM ubuntu:22.04

# ! apt-get update で名前解決ができない
# Temporary failure resolving 'archive.ubuntu.com'
# Temporary failure resolving 'security.ubuntu.com'
# ┬──────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
# │ File: /etc/wsl.conf
# ┼──────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
# │ [boot]
# │ systemd=true
# ┼──────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
# │ [boot]
# │ systemd=true
# │ [network]
# │ generateResolvConf = false
# ┴──────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
# wsl --shutdown
# ┬──────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
# │ File: /etc/resolv.conf
# ┼──────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
# │ # This file was automatically generated by WSL. To stop automatic generation of this file, add the following entry to /etc/wsl.conf:
# │ # [network]
# │ # generateResolvConf = false
# │ nameserver 172.17.144.1
# ┴──────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
# │ nameserver 8.8.8.8
# ┴──────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
# wsl --shutdown

RUN apt-get update && apt-get upgrade

RUN apt-get install sudo

ARG WORK_USER
ARG WORK_GROUP
ARG WORK_UID
ARG WORK_GID

RUN groupadd --gid $WORK_GID $WORK_GROUP \
    && useradd --gid $WORK_GID --groups sudo --uid $WORK_UID --create-home --shell /bin/bash $WORK_USER \
    && echo $WORK_USER:$WORK_USER | chpasswd \
    && echo "$WORK_USER ALL=(ALL) NOPASSWD:ALL" >> /etc/sudoers

USER $WORK_USER
WORKDIR /home/$WORK_USER/
